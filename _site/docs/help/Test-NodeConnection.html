<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test-NodeConnection | CheckIT-Core Documentation</title>
  <link rel="stylesheet" href="/CheckIT-Documentation/assets/style.css">
</head>
<body>
  <div class="site-container">
    <header class="site-header">
      <div class="wrapper">
        <a class="site-title" href="/CheckIT-Documentation/">CheckIT-Core</a>
        <nav class="site-nav">
          <div class="nav-row">
            
              <a href="/CheckIT-Documentation/docs/README" class="page-link">‚ÑπÔ∏è About</a>
            
              <a href="/CheckIT-Documentation/docs/get-started" class="page-link">üöÄ Get Started</a>
            
              <a href="/CheckIT-Documentation/docs/api-reference" class="page-link">üìò API Reference</a>
            
              <a href="/CheckIT-Documentation/docs/quick-reference" class="page-link">‚ö° Quick Reference</a>
            
              <a href="/CheckIT-Documentation/docs/templateInfo" class="page-link">üß© Template System</a>
            
          </div>
          <div class="nav-row">
            
              <a href="/CheckIT-Documentation/docs/troubleshooting" class="page-link">üîç Troubleshooting</a>
            
              <a href="/CheckIT-Documentation/docs/internal-helpers" class="page-link">üîß Internal Helper Functions</a>
            
              <a href="/CheckIT-Documentation/CHANGELOG" class="page-link">üìã Changelog</a>
            
          </div>
        </nav>
      </div>
    </header>

    <main class="page-content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Test-NodeConnection</h1>
  </header>

  <div class="post-content">
    <h1 id="test-nodeconnection">Test-NodeConnection</h1>

<hr />
<p>external help file: checkit-core-help.xml
Module Name: checkit-core
online version:
schema: 2.0.0
‚Äî</p>

<h1 id="test-nodeconnection-1">Test-NodeConnection</h1>

<h2 id="synopsis">SYNOPSIS</h2>

<p>Tests connectivity, WinRM, WSMan authentication, and Win32PowerManagement service for nodes, with robust parallel and reporting support.</p>

<h2 id="syntax">SYNTAX</h2>

<p>Test-NodeConnection [-Nodes] <Array> [[-PromptUser] <Boolean>] [-OnlineOnly] [[-Report] <Boolean>]
 [[-StatusCallback] <ScriptBlock>] [-ProgressAction <ActionPreference>] [<CommonParameters>]</CommonParameters></ActionPreference></ScriptBlock></Boolean></Boolean></Array></p>

<h2 id="description">DESCRIPTION</h2>

<p>For each node, checks network connectivity (ping), WinRM, and WSMan authentication, and optionally the Win32PowerManagement service.
Handles credentials using Get-NodeCredAndFQDN, supports robust error and task logging, and is safe for both CLI and GUI/automation.
Uses Process-Parallel for batch processing, but handles single-node gracefully.</p>

<h2 id="examples">EXAMPLES</h2>

<h3 id="example-1">EXAMPLE 1</h3>

<p>Test-NodeConnection -Nodes $global:nodeList -PromptUser:$false</p>

<h3 id="example-2">EXAMPLE 2</h3>

<h1 id="run-in-gui-skip-report-generation">Run in GUI, skip report generation:</h1>
<p>Test-NodeConnection -Nodes $global:nodeList -PromptUser:$false -Report:$false</p>

<h3 id="example-3">EXAMPLE 3</h3>

<h1 id="only-check-if-nodes-are-online-ping">Only check if nodes are online (ping):</h1>
<p>Test-NodeConnection -Nodes $global:nodeList -OnlineOnly</p>

<h2 id="parameters">PARAMETERS</h2>

<h3 id="-nodes">-Nodes</h3>

<p>Array of node objects or node names to test.</p>

<p>```yaml
Type: Array
Parameter Sets: (All)
Aliases:</p>

<p>Required: True
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False</p>

<h3 id="-promptuser">-PromptUser</h3>

<p>If set, enables CLI prompts and colored output.
Set to $false for GUI use.</p>

<p>```yaml
Type: Boolean
Parameter Sets: (All)
Aliases:</p>

<p>Required: False
Position: 2
Default value: True
Accept pipeline input: False
Accept wildcard characters: False</p>

<h3 id="-onlineonly">-OnlineOnly</h3>

<p>If set, only tests if the node is online (ping), skipping WinRM, WSMan, and Win32PM checks.</p>

<p>```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:</p>

<p>Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False</p>

<h3 id="-report">-Report</h3>

<p>If set (default), writes results to the task log and report.
If $false, only logs tasks/errors.</p>

<p>```yaml
Type: Boolean
Parameter Sets: (All)
Aliases:</p>

<p>Required: False
Position: 3
Default value: True
Accept pipeline input: False
Accept wildcard characters: False</p>

<h3 id="-statuscallback">-StatusCallback</h3>

<p>Optional scriptblock for progress reporting.</p>

<p>```yaml
Type: ScriptBlock
Parameter Sets: (All)
Aliases:</p>

<p>Required: False
Position: 4
Default value: None
Accept pipeline input: False
Accept wildcard characters: False</p>

<h3 id="-progressaction">-ProgressAction</h3>

<p>```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: proga</p>

<p>Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False</p>

<h3 id="commonparameters">CommonParameters</h3>

<p>This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see <a href="http://go.microsoft.com/fwlink/?LinkID=113216">about_CommonParameters</a>.</p>

<h2 id="inputs">INPUTS</h2>

<h2 id="outputs">OUTPUTS</h2>

<h3 id="array-of-result-objects-for-each-node-tested-with-properties-such-as-node-online-winrm-wsmanauth-username-logontime-win32pm-taskstatus-lastreboot-lasterror">Array of result objects for each node tested, with properties such as Node, Online, WinRM, WSManAuth, UserName, LogonTime, Win32PM, TaskStatus, LastReboot, LastError</h3>

<h2 id="notes">NOTES</h2>

<ul>
  <li>Uses Process-Parallel for robust batch processing.</li>
  <li>Uses enhanced credential pre-resolution for secure parallel execution.</li>
  <li>Always logs tasks/errors; report generation is optional.</li>
  <li>Returns PSCustomObjects with ‚Äú‚Äù for missing/null values for GUI/CLI safety.</li>
</ul>

<h2 id="related-links">RELATED LINKS</h2>


  </div>

</article>

      </div>
    </main>
  </div>

  <script src="/CheckIT-Documentation/assets/js/code-blocks.js"></script>
  <script src="/CheckIT-Documentation/assets/js/function-links.js"></script>
  <script src="/CheckIT-Documentation/assets/js/field-icons.js"></script>
  <script src="/CheckIT-Documentation/assets/js/functionCardTabs.js"></script>  
</body>
</html>